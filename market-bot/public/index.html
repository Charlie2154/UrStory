<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Albion Market Live</title>
    <style>
      body { font-family: system-ui, Arial; padding: 16px; }
      .item { border-bottom: 1px solid #eee; padding: 8px 0; }
      .city { font-size: 0.9rem; color: #555; }
      .price { font-weight: 600; }
    </style>
  </head>
  <body>
    <h1>Albion Market Live (prototype)</h1>
    <div id="feed"></div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
      const socket = io(location.origin.replace(location.port, '4000'));
      const feed = document.getElementById('feed');

      socket.on('connect', () => console.log('connected', socket.id));
      socket.on('price_update_global', (data) => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `<div><strong>${data.itemId}</strong> <span class="city">${(data.region||[]).join(',')}</span></div><pre>${JSON.stringify(data.prices,null,2)}</pre>`;
        feed.prepend(el);
      });
    </script>
  </body>
 </html>
